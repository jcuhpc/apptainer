Bootstrap: localimage
From: /gpfs01/Q0195/containers/ubuntu-20.04.sif

%runscript
exec "$@"

%post
cd /opt  && \
apt-get update  &&  \
apt-get upgrade -y  &&  \
apt install -y --no-install-recommends cython3 g++ gnuplot-nox libbz2-dev libcurl4-openssl-dev libgmp-dev libgsl-dev liblzma-dev libmpfr-dev libssl-dev python3-appdirs python3-dev python3-pip python3-setuptools python3-setuptools-scm python3-tqdm  &&  \
apt-get clean  &&  apt-get purge  &&  rm -rf /var/lib/apt/lists/*  &&  \
pip3 install "scipy>=1.8" "numpy>=1.20,<2" "matplotlib>=3" "pysam>=0.18" "pandas>=1.4" "scikit-learn>=1" msprime  &&  \
# python3-sklearn
git clone https://github.com/popgenmethods/smcpp --branch=v1.15.4  && \
cd smcpp  &&  python3 setup.py install

%environment
export PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

