Bootstrap: localimage
From: /gpfs01/sw/containers/Python-3.11.sif

%runscript
exec "$@"

%post
cd /opt  &&  \
VERS=1.2.1  &&  \
apt-get update  &&  \
apt-get install -y libc6-dev  &&  \
apt-get clean  &&  apt-get purge  &&  rm -rf /var/lib/apt/lists/*  &&  \
wget https://github.com/yfukasawa/LongQC/archive/refs/tags/v$VERS.tar.gz  &&  \
pip3 install numpy scipy matplotlib scikit-learn pandas jinja2 h5py pysam edlib  &&  \
tar xf v$VERS.tar.gz  &&  rm -f v$VERS.tar.gz  &&  \
mv LongQC-$VERS LongQC  &&  \
cd LongQC/minimap2-coverage  &&  make  &&  \
chmod 775 /opt/LongQC/longQC.py

%environment
export PATH="/opt/LongQC:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

